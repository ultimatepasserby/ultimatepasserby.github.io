---
layout: post
title: "云计算学习笔记"
date: 2022-04-05
categories: [云计算工程师]
---
# 云计算笔记

### 第一部分：企业上云的核心流程与操作

#### 1. 评估与规划 (Assessment & Planning)
- **业务目标对齐**：明确企业上云的核心驱动因素至关重要。成本优化可通过云服务的按需付费模式减少硬件和维护成本；敏捷性则体现在能够快速部署新的应用和服务；创新可以借助云平台的先进技术，如人工智能和大数据分析；弹性允许企业根据业务需求灵活调整资源；业务连续性则确保在遇到灾难时能够快速恢复业务。
- **应用评估**
    - **发现与盘点**：全面梳理现有 IT 资产，包括服务器、应用、数据库、网络架构以及它们之间的依赖关系。这有助于了解企业的 IT 现状，为后续的迁移规划提供基础。
    - **云适配性分析**：使用 6R 策略评估每个应用的迁移可行性、复杂度和成本效益。Rehost（重新托管）是直接将应用迁移到云，不做代码更改；Replatform（重新平台化）对应用进行少量修改以利用云托管服务；Refactor（重构）将应用重构为云原生架构；Repurchase（重新购买）选择云市场上的替代软件；Retire（淘汰）停止使用不再需要的应用；Retain（保留）继续在本地运行应用。
    - **依赖关系映射**：识别应用间的相互依赖，确定迁移批次和顺序，避免因迁移顺序不当导致的系统故障。
- **成本建模与优化**：使用云厂商的定价计算器估算上云成本，比较不同服务类型，如预留实例可提供长期使用的折扣，按需实例则适合短期或突发的工作负载。通过合理选择服务类型和优化策略，可以降低上云成本。
- **云服务商选择**：根据企业的需求，如服务类型、区域覆盖、合规性、价格、技术栈支持、生态系统和支持服务等，评估并选择公有云（如 AWS、Azure、GCP、阿里云、腾讯云等）、私有云或混合云/多云策略。
- **安全与合规性评估**：识别现有安全策略，评估云环境下的合规要求，如 GDPR、HIPAA、PCI DSS 等。规划云安全架构，遵循责任共担模型，明确云厂商和客户各自的安全责任。
- **技能评估与培训**：评估团队现有云技能，制定培训计划，确保团队具备上云所需的技能和知识。
- **制定迁移策略与路线图**：确定整体迁移方法，如大爆炸（一次性迁移）、分批迁移或混合过渡。制定时间表和资源计划，确保迁移工作有序进行。

#### 2. 设计与架构 (Design & Architecture)
- **目标架构设计**
    - **网络架构**：设计 VPC/VNet/VCN，包括子网划分、路由表、NAT 网关、VPN/专线连接、对等连接等。规划混合云连接架构，选择合适的负载均衡策略和 DNS 规划，确保网络的安全性和可靠性。
    - **计算架构**：根据应用的需求，选择虚拟机（如 EC2、VM、CVM）、容器（如 Kubernetes/EKS/AKS/GKE）、无服务器（如 Lambda/Azure Functions/Cloud Functions）或 PaaS 服务。
    - **存储架构**：选择合适的存储类型，如对象存储（S3、Blob、OSS）、块存储（EBS、Managed Disks、CBS）、文件存储（EFS、Azure Files、CFS）和数据库存储。
    - **数据库架构**：确定迁移策略（同构/异构），选择托管数据库服务（如 RDS、Azure SQL、Cloud SQL、NoSQL 服务）或自建数据库。
    - **安全架构**：设计 IAM 策略，遵循最小权限原则，设置网络安全组/ACL、Web 应用防火墙、密钥管理和数据加密。进行审计与日志记录，确保系统的安全性。
    - **高可用与灾备设计**：采用多可用区部署、自动伸缩组、负载均衡器健康检查、跨区域复制、备份与恢复策略等，确保系统的高可用性和灾难恢复能力。
- **选择云服务**：根据架构需求选择具体的云服务，如消息队列（SQS 或 Kafka）、数据库（Aurora 或 DynamoDB）等。
- **成本优化设计**：在架构层面融入成本考量，如使用 Spot 实例、选择合适的存储类型、预留实例规划等，降低运营成本。

#### 3. 迁移与部署 (Migration & Deployment)
- **环境准备**：在云上搭建好网络、安全基础架构，确保迁移环境的稳定性和安全性。
- **数据迁移**
    - **数据库迁移**：使用工具（如 AWS DMS、Azure DMS、Striim、GoldenGate）进行在线/离线迁移，处理模式转换和数据校验，确保数据的准确性和完整性。
    - **存储迁移**：使用工具（如 AWS DataSync、Azure AzCopy/Data Box、rsync）或 API 迁移文件、对象数据。
- **应用迁移/部署**
    - **Rehost (Lift-and-Shift)**：使用迁移工具（如 AWS VM Import/Export、Azure Migrate Server Migration）直接将虚拟机镜像迁移到云虚拟机。关键技术包括镜像转换、P2V/V2V 工具和云迁移专用服务。
    - **Replatform (Lift-tinker-and-Shift)**：对应用进行少量修改以利用云托管服务，如将自建 MySQL 迁移到 RDS。关键技术包括数据库迁移服务和配置管理。
    - **Refactor (Re-architect)**：重构应用为云原生架构（微服务、容器化、无服务器）。关键技术包括容器技术（Docker）、容器编排（Kubernetes）、CI/CD 流水线、无服务器框架和 API 网关。
- **测试**：进行功能测试、性能测试、安全测试和灾难恢复测试，确保迁移后的系统满足业务需求。
- **切换 (Cutover)**：规划并执行从旧系统到新云环境的流量切换（DNS 切换、负载均衡器配置），可能涉及回滚计划，以应对可能出现的问题。

#### 4. 运维与优化 (Operations & Optimization)
- **持续监控**：使用云监控服务（如 CloudWatch、Azure Monitor、Stackdriver）监控资源利用率、应用性能、日志和事件。关键技术包括指标收集、日志聚合（如 ELK Stack、Splunk、Cloud Logging）、告警配置和 APM 工具。
- **自动化运维**：利用基础设施即代码（IaC - Terraform、CloudFormation、ARM/Bicep）、配置管理（Ansible、Puppet、Chef）和自动化脚本实现资源部署、配置和管理的自动化，提高运维效率。
- **成本监控与优化**：持续监控云账单，使用成本管理工具识别浪费（如空闲资源、未充分利用资源），实施优化措施（如调整实例大小、购买预留实例、使用 Spot 实例、删除未使用资源）。关键技术包括云成本管理工具（如 AWS Cost Explorer、Azure Cost Management）和第三方优化工具。
- **安全管理**：持续进行安全配置审计、漏洞扫描、补丁管理和访问权限审查。关键技术包括 CSPM 工具和 SIEM 集成。
- **性能优化**：根据监控数据调整资源配置、优化数据库查询、优化应用代码和利用 CDN 等，提高系统性能。
- **备份与灾难恢复**：定期验证备份有效性，执行灾难恢复演练，确保在遇到灾难时能够快速恢复业务。

### 第二部分：企业上云的关键技术与知识点

#### 1. 核心云服务模型
- **IaaS**：提供虚拟机、网络、存储等基础资源的抽象和管理，用户可以在这些资源上部署和运行自己的应用。例如，AWS 的 EC2、VPC 和 EBS，Azure 的 VM、VNet 和 Managed Disks。
- **PaaS**：提供托管应用平台和服务，如数据库（RDS/Azure SQL）、消息队列（SQS/Service Bus）和容器服务（EKS/AKS）。重点是免运维基础设施，用户无需管理底层的硬件和操作系统。
- **SaaS**：提供直接使用的应用软件，如 Office 365 和 Salesforce。用户只需通过浏览器访问软件，无需进行安装和维护。
- **FaaS/Serverless**：提供事件驱动的无服务器计算模型，如 Lambda 和 Azure Functions。其优势包括按需付费、自动伸缩，适用于处理突发的、短暂的任务。

#### 2. 网络与安全
- **虚拟网络**：深入理解 VPC/VNet 概念，包括子网、路由表、网关、NAT、对等连接和端点服务。通过合理的网络设计，可以提高网络的安全性和性能。
- **混合云连接**：了解 VPN（IPSec）和专线（Direct Connect、ExpressRoute）的原理、配置和选型，实现本地数据中心与云之间的连接。
- **负载均衡**：了解应用层（ALB/Application Gateway）与网络层（NLB/Network Load Balancer）的区别和应用场景，通过负载均衡可以提高应用的可用性和性能。
- **DNS**：掌握云 DNS 服务（如 Route 53、Azure DNS）的管理和配置，确保域名的正确解析。
- **云安全责任共担模型**：清晰理解云厂商负责物理安全、虚拟化层等，客户负责 OS 补丁、应用安全、数据加密、IAM 配置和网络安全组等。
- **身份与访问管理**：了解 IAM 用户/组/角色、权限策略（最小权限原则）、多因素认证和联合身份认证，确保系统的访问安全。
- **网络安全**：掌握安全组（状态防火墙）、网络 ACL（无状态防火墙）和 Web 应用防火墙的原理和配置，保护网络免受攻击。
- **数据安全**：了解传输加密（TLS/SSL）、静态加密（KMS/Key Vault 管理密钥）和密钥管理最佳实践，确保数据的安全性。
- **日志与审计**：掌握安全日志（如 CloudTrail/Azure Activity Log）的收集、存储和分析，及时发现和处理安全事件。

#### 3. 计算
- **虚拟机**：了解实例类型（计算/内存/存储/GPU 优化）、镜像管理和生命周期管理，根据应用需求选择合适的虚拟机实例。
- **容器**
    - **Docker**：掌握镜像、容器和仓库的核心概念，通过 Docker 可以实现应用的打包和部署。
    - **Kubernetes**：理解 Pod、Deployment、Service、Ingress、ConfigMap、Secret 和持久卷等核心概念，掌握托管 K8s 服务（如 EKS、AKS、GKE）的使用和管理，实现容器的编排和调度。
- **无服务器**：了解函数计算（如 Lambda/Azure Functions）的触发器、执行环境、冷启动和最佳实践，适用于处理无状态的、短暂的任务。

#### 4. 存储
- **对象存储**：掌握 S3/Blob Storage 的核心概念（桶/容器、对象、存储类别 - 标准/低频/归档）、API、版本控制和生命周期管理，适用于存储大量的非结构化数据。
- **块存储**：了解 EBS/Managed Disks 的类型（SSD/HDD）、性能指标（IOPS、Throughput）和快照管理，适用于需要高性能存储的应用。
- **文件存储**：掌握共享文件系统（如 EFS/Azure Files）的使用场景和配置，适用于多个实例共享文件的场景。
- **数据库存储**：理解不同数据库服务（关系型、NoSQL）的存储引擎和特性，根据应用需求选择合适的数据库。

#### 5. 数据库
- **托管关系数据库**：了解 RDS/Azure SQL Database/Cloud SQL 的核心功能（自动备份、主从复制、读写分离、自动扩展）、参数配置和迁移工具（DMS），适用于需要高可用性和可扩展性的关系型数据库应用。
- **NoSQL 数据库**：掌握 DynamoDB/Cosmos DB/Firestore 的核心概念（键值/文档/宽列/图）、数据模型、读写吞吐量配置和分区键设计，适用于处理大量的非结构化数据。
- **数据库迁移策略与挑战**：了解在线迁移和离线迁移的区别，掌握数据一致性校验的方法，应对数据库迁移过程中的挑战。

#### 6. 自动化与 DevOps
- **基础设施即代码**
    - **Terraform**：掌握 HCL 语法、Provider、Resource、State 管理和模块化，通过 Terraform 可以实现基础设施的自动化部署和管理。
    - **CloudFormation / ARM Templates / Deployment Manager**：了解云厂商原生 IaC 工具，实现基础设施的自动化部署。
- **配置管理**：了解 Ansible/Puppet/Chef/SaltStack 的基础知识，通过配置管理工具可以实现服务器的自动化配置和管理。
- **持续集成/持续部署**
    - **CI/CD 流水线**：理解构建、测试、部署的自动化流程，通过 CI/CD 流水线可以提高软件的交付效率和质量。
    - **工具链**：掌握 Jenkins、GitLab CI/CD、GitHub Actions、AWS CodePipeline 和 Azure DevOps Pipelines 的使用和集成，实现 CI/CD 流程的自动化。
- **脚本能力**：掌握 Shell (Bash)、Python 和 PowerShell 等脚本语言，用于自动化运维和开发。

#### 7. 监控、日志与可观测性
- **监控指标**：了解 CPU、内存、磁盘、网络等基础指标和应用自定义指标，通过监控指标可以及时发现系统的性能问题。
- **日志管理**：掌握系统日志和应用日志的收集（如 CloudWatch Logs Agent、Fluentd、Filebeat）、聚合、存储（如 CloudWatch Logs、Azure Monitor Logs、Elasticsearch）和查询分析，通过日志管理可以快速定位和解决问题。
- **分布式追踪**：了解在微服务/Serverless 架构中跟踪请求链路（如 AWS X-Ray、Azure Application Insights），通过分布式追踪可以了解请求在系统中的执行过程，提高系统的可观测性。
- **告警**：基于指标或日志设置阈值告警，及时通知运维人员处理问题。

#### 8. 成本管理
- **云定价模型**：理解按需实例、预留实例（标准/可转换）、Savings Plans 和 Spot 实例的适用场景和成本差异，通过合理选择定价模型可以降低云成本。
- **成本监控工具**：熟练使用云厂商提供的成本管理控制台和报告，及时了解云成本的使用情况。
- **成本优化策略**：掌握识别和关闭闲置资源、选择合适实例类型和大小、利用自动伸缩、使用 Spot 实例、购买预留容量、优化存储生命周期和类型等成本优化策略，降低云成本。

#### 9. 高可用与灾备
- **高可用设计**：理解多可用区部署、负载均衡、自动故障转移、数据库主从复制/多副本等高可用设计原则，确保系统的高可用性。
- **灾难恢复策略**：掌握备份与恢复（快照、备份服务）、跨区域复制、灾备站点（温备/热备）的设计与实施，确保在遇到灾难时能够快速恢复业务。

### 第三部分：面试官常考察的关键点及回答建议

#### 1. 理解 6R 迁移策略并能举例说明应用场景
- **回答思路**：首先简要介绍 6R 策略的定义，然后分别举例说明每个策略的应用场景。
- **示例回答**：6R 迁移策略包括 Rehost（重新托管）、Replatform（重新平台化）、Refactor（重构）、Repurchase（重新购买）、Retire（淘汰）和 Retain（保留）。Rehost 适用于对应用进行快速迁移，不做代码更改，例如将传统的 Web 应用直接迁移到云虚拟机。Replatform 适用于对应用进行少量修改以利用云托管服务，如将自建 MySQL 数据库迁移到 RDS。Refactor 适用于需要提高应用性能和可扩展性的场景，如将单体应用重构为微服务架构。Repurchase 适用于选择云市场上的替代软件，如将本地的办公软件替换为 Office 365。Retire 适用于停止使用不再需要的应用，如淘汰过时的业务系统。Retain 适用于继续在本地运行应用，如对安全性要求极高的关键业务系统。

#### 2. 深入理解云安全责任共担模型并能具体说明客户责任
- **回答思路**：首先解释云安全责任共担模型的概念，然后详细说明客户的责任。
- **示例回答**：云安全责任共担模型是指云厂商和客户共同承担云环境的安全责任。云厂商负责物理安全、虚拟化层等基础设施的安全，客户负责 OS 补丁、应用安全、数据加密、IAM 配置和网络安全组等。具体来说，客户需要及时更新操作系统的补丁，确保应用程序的安全，对敏感数据进行加密，合理配置 IAM 用户和角色的权限，设置网络安全组来控制网络访问。

#### 3. 精通 IAM 策略设计（最小权限原则）
- **回答思路**：解释最小权限原则的概念，然后说明如何在 IAM 策略设计中应用该原则。
- **示例回答**：最小权限原则是指只授予用户完成工作所需的最少权限。在 IAM 策略设计中，首先需要明确用户的工作职责和权限需求，然后根据这些需求创建最小化的权限策略。例如，对于一个只需要读取数据库的用户，只授予其读取数据库的权限，而不授予写入或删除数据的权限。同时，定期审查和更新权限策略，确保用户的权限始终符合其工作职责。

#### 4. 熟练掌握 VPC/VNet 网络设计和安全组/ACL 配置
- **回答思路**：简要介绍 VPC/VNet 的概念，然后说明网络设计的要点和安全组/ACL 的配置方法。
- **示例回答**：VPC/VNet 是虚拟专用网络，用于在云中创建隔离的网络环境。在进行 VPC/VNet 网络设计时，需要考虑子网划分、路由表配置、NAT 网关和 VPN/专线连接等。安全组是一种状态防火墙，用于控制入站和出站的网络流量，需要根据应用的需求配置安全组规则。网络 ACL 是一种无状态防火墙，用于控制子网级别的网络流量，需要根据子网的安全需求配置网络 ACL 规则。

#### 5. 有实际使用 Terraform 或 CloudFormation 部署复杂基础设施的经验
- **回答思路**：分享使用 Terraform 或 CloudFormation 部署复杂基础设施的项目经验，包括项目背景、遇到的挑战和解决方案。
- **示例回答**：在一个项目中，我使用 Terraform 部署了一个复杂的云计算基础设施，包括多个虚拟机、负载均衡器、数据库和存储服务。在部署过程中，遇到了资源依赖和配置管理的挑战。为了解决这些问题，我使用了 Terraform 的模块化功能，将基础设施拆分成多个模块，提高了代码的可维护性和复用性。同时，使用 Terraform 的状态管理功能，确保资源的状态始终保持一致。

#### 6. 理解 Kubernetes 核心概念并能说明其在云原生应用中的作用
- **回答思路**：解释 Kubernetes 的核心概念，如 Pod、Deployment、Service 等，然后说明 Kubernetes 在云原生应用中的作用。
- **示例回答**：Kubernetes 的核心概念包括 Pod、Deployment、Service、Ingress、ConfigMap、Secret 和持久卷等。Pod 是 Kubernetes 中最小的可部署单元，包含一个或多个容器。Deployment 用于管理 Pod 的副本数量和更新策略。Service 用于暴露 Pod 的服务，提供负载均衡和服务发现功能。Ingress 用于管理外部对服务的访问。ConfigMap 和 Secret 用于存储配置信息和敏感数据。持久卷用于提供持久化存储。在云原生应用中，Kubernetes 可以实现容器的自动化部署、扩展和管理，提高应用的可用性和可扩展性。

#### 7. 熟悉 CI/CD 流程和工具，能设计自动化部署流水线
- **回答思路**：介绍 CI/CD 流程的概念，然后说明常用的 CI/CD 工具和如何设计自动化部署流水线。
- **示例回答**：CI/CD 流程包括持续集成和持续部署。持续集成是指开发人员将代码频繁地集成到共享代码库中，并自动进行构建和测试。持续部署是指将通过测试的代码自动部署到生产环境中。常用的 CI/CD 工具包括 Jenkins、GitLab CI/CD、GitHub Actions、AWS CodePipeline 和 Azure DevOps Pipelines 等。在设计自动化部署流水线时，需要根据项目的需求选择合适的 CI/CD 工具，定义构建、测试和部署的步骤，配置环境变量和密钥，确保流水线的自动化和可靠性。

#### 8. 具备强烈的成本优化意识，了解主要优化手段
- **回答思路**：强调成本优化的重要性，然后介绍主要的成本优化手段。
- **示例回答**：成本优化是企业上云的重要目标之一。主要的成本优化手段包括识别和关闭闲置资源、选择合适实例类型和大小、利用自动伸缩、使用 Spot 实例、购买预留容量、优化存储生命周期和类型等。例如，定期检查云资源的使用情况，关闭不再使用的实例和存储；根据应用的负载情况选择合适的实例类型和大小；使用自动伸缩功能根据负载自动调整资源数量；使用 Spot 实例处理非关键任务，降低成本；购买预留容量以获得折扣；优化存储的生命周期，将不常用的数据存储到低成本的存储类型中。

#### 9. 有使用云监控和日志服务排查问题的经验
- **回答思路**：分享使用云监控和日志服务排查问题的项目经验，包括问题描述、排查过程和解决方案。
- **示例回答**：在一个项目中，应用出现了性能下降的问题。我首先使用云监控服务查看了 CPU、内存、磁盘和网络等指标，发现 CPU 使用率过高。然后通过日志服务查看了应用的日志，发现是某个数据库查询导致了性能问题。我对该查询进行了优化，重新部署应用后，性能问题得到了解决。

#### 10. 了解数据库迁移的挑战和常用工具（如 DMS）
- **回答思路**：介绍数据库迁移的挑战，如数据一致性、性能影响等，然后说明常用的数据库迁移工具和使用方法。
- **示例回答**：数据库迁移的挑战包括数据一致性、性能影响、兼容性问题等。在迁移过程中，需要确保数据的完整性和一致性，避免数据丢失或损坏。同时，迁移过程可能会对业务系统的性能产生影响，需要合理安排迁移时间。常用的数据库迁移工具包括 AWS DMS、Azure DMS、Striim 和 GoldenGate 等。以 AWS DMS 为例，它可以实现在线和离线迁移，支持多种数据库类型，通过配置迁移任务可以实现数据的迁移和同步。

#### 11. 理解无服务器架构的优缺点和适用场景
- **回答思路**：分别阐述无服务器架构的优点、缺点和适用场景。
- **示例回答**：无服务器架构的优点包括按需付费、自动伸缩、无需管理服务器等。它可以降低成本，提高开发效率，适用于处理突发的、短暂的任务。缺点包括冷启动问题、供应商锁定、调试困难等。冷启动可能会导致应用的响应时间增加，供应商锁定可能会限制技术的选择，调试困难可能会增加问题排查的难度。无服务器架构适用于处理事件驱动的任务，如文件上传、数据处理、定时任务等。

#### 12. 具备一定的脚本能力（Python/Bash/PowerShell）